"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5699],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>d});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),s=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=s(r),y=n,d=p["".concat(l,".").concat(y)]||p[y]||h[y]||i;return r?a.createElement(d,o(o({ref:t},u),{},{components:r})):a.createElement(d,o({ref:t},u))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=y;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c[p]="string"==typeof e?e:n,o[1]=c;for(var s=2;s<i;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}y.displayName="MDXCreateElement"},2164:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>s});var a=r(7462),n=(r(7294),r(3905));const i={id:"query-cache",title:"Query Caching",sidebar_label:"Query Caching",sidebar_position:8},o=void 0,c={unversionedId:"reference/query-cache",id:"reference/query-cache",title:"Query Caching",description:"When GraphQL ASP.NET parses a query, it generates a query plan that contains all the required data needed to execute the requested operation. For most queries this process is near instantaneous but in some particularly large queries it may take an extra moment to generate a full query plan. The query cache will help alleviate this bottleneck by caching a plan for a set period of time to skip the parsing and generation phases when completing a request.",source:"@site/docs/reference/query-caching.md",sourceDirName:"reference",slug:"/reference/query-cache",permalink:"/docs/reference/query-cache",draft:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"query-cache",title:"Query Caching",sidebar_label:"Query Caching",sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Pipelines & Middleware",permalink:"/docs/reference/middleware"},next:{title:"Demo Projects",permalink:"/docs/reference/demo-projects"}},l={},s=[{value:"Enabling the Query Cache",id:"enabling-the-query-cache",level:2}],u={toc:s};function p(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"When GraphQL ASP.NET parses a query, it generates a query plan that contains all the required data needed to execute the requested operation. For most queries this process is near instantaneous but in some particularly large queries it may take an extra moment to generate a full query plan. The query cache will help alleviate this bottleneck by caching a plan for a set period of time to skip the parsing and generation phases when completing a request."),(0,n.kt)("p",null,"The query cache makes a concerted effort to only cache plans that are truly unique and thus it will take a moment to analyze the incoming query to see if it identical to one that is already cached. For small queries the amount of time it takes to scrub the query text and look up a plan in the cache could be ",(0,n.kt)("em",{parentName:"p"},"as long")," as reparsing the query (200-300\u03bcs)."),(0,n.kt)("p",null,"Consider using the Query Cache only if:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Your application's individual query size is regularly more than 1000 characters in length"),(0,n.kt)("li",{parentName:"ul"},"You make use of a lot of interface graph types and a lot of object graph types for each of those interfaces."),(0,n.kt)("li",{parentName:"ul"},"When ",(0,n.kt)("a",{parentName:"li",href:"../execution/metrics"},"Profiling")," reveals a bottleneck in the ",(0,n.kt)("inlineCode",{parentName:"li"},"parsing")," phase of any given query.")),(0,n.kt)("h2",{id:"enabling-the-query-cache"},"Enabling the Query Cache"),(0,n.kt)("p",null,"At startup, inject the query cache into the service collection. The cache itself is schema agnostic."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csharp",metastring:'title="Startup Code"',title:'"Startup','Code"':!0},"// Register the query cache BEFORE calling .AddGraphQL\n// highlight-next-line\nservices.AddGraphQLLocalQueryCache();\n\nservices.AddGraphQL();\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Note:")," Because a query plan contains function pointers and references to local types, the default query cache is currently restricted to being in-process for a single server instance. Query Plan serialization for a shared cache such as Redis is on the road map after v1.0 is complete. If you would like to contribute in this area please reach out!"))}p.isMDXComponent=!0}}]);